<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <title>Dettaglio Prodotto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>

<body class="position-relative" style="min-height: 100vh;">
    <div class="container my-4 position-absolute top-50 start-50 translate-middle">
        <div id="alert-container"></div>
        <div class="row g-4" id="product-detail"></div>
    </div>

    <script>
        const baseURL = "https://striveschool-api.herokuapp.com/api/product/";
        const key = "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2OGNkMGU2NTZmMzAyMjAwMTUxMDgwY2QiLCJpYXQiOjE3NTgyNjkwMjksImV4cCI6MTc1OTQ3ODYyOX0.heSqHpY9vfaJL_v1tBNf9ra7RGKoiPlI3IZRe_hE5Zo";
        const params = new URLSearchParams(window.location.search);
        const id = params.get("id");

        function getHeaders() { return { "Authorization": key }; }
        function showAlert(msg, type = "info") {
            document.getElementById("alert-container").innerHTML =
                `<div class="alert alert-${type}">${msg}</div>`;
        }

        // btn torna indietro
        function goBack() {
            window.history.back();
        }

        async function loadProduct() {
            try {
                const res = await fetch(baseURL + id, { headers: getHeaders() });
                if (!res.ok) throw new Error("Errore " + res.status);
                const p = await res.json();
                document.getElementById("product-detail").innerHTML = `
        <div class="col-md-6 d-flex justify-content-md-end">
          <img src="${p.imageUrl}" class="img-fluid rounded">
        </div>
        <div class="col-md-6">
          <h2>${p.name}</h2>
          <p>${p.description}</p>
          <h4>â‚¬ ${p.price}</h4>
          <p><strong>Brand:</strong> ${p.brand}</p>
          <button class="btn btn-success">Aggiungi al carrello</button>
          <button class="btn btn-secondary" onclick="goBack()">Torna indietro</button>
        </div>
        <div class=text-center>
            <img src="https://www.agriturismolameridiana.it/wp-content/uploads/super-offerta1-pronto-legna-da-ardere-castelli-romani1.gif" alt="offertissimo"></div>`;
            } catch (err) {
                showAlert("Errore caricamento: " + err.message, "danger");
            }
        }

        loadProduct();
    </script>
</body>

</html>